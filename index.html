<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. Nim: IA Training Session</title>
    <style>
        :root { --neon-blue: #00f2ff; --neon-pink: #ff0055; --bg: #0d0d0d; }
        body { font-family: 'Courier New', Courier, monospace; background: var(--bg); color: white; text-align: center; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; border: 2px solid #333; padding: 20px; border-radius: 15px; background: #000; box-shadow: 0 0 20px rgba(0,242,255,0.1); }
        
        /* Cabe√ßalho e Placar */
        .header { margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .round-info { font-size: 1.2rem; color: var(--neon-blue); margin-bottom: 10px; }
        .score-row { display: flex; justify-content: space-around; font-size: 1.1rem; }
        
        /* Tabuleiro */
        .board { display: flex; justify-content: center; gap: 10px; margin: 40px 0; }
        .cell { width: 50px; height: 50px; border: 1px solid #444; display: flex; align-items: center; justify-content: center; border-radius: 8px; transition: 0.4s; position: relative; }
        .cell.active { background: var(--neon-blue); color: black; box-shadow: 0 0 15px var(--neon-blue); transform: scale(1.1); }
        .cell.nim-active { background: var(--neon-pink); box-shadow: 0 0 15px var(--neon-pink); color: white; }
        .diamond-icon { font-size: 1.5rem; }

        /* Console de Mensagens */
        #console { background: #111; border-left: 4px solid var(--neon-blue); padding: 15px; text-align: left; min-height: 60px; margin: 20px 0; font-size: 0.9rem; color: #0f0; }

        /* Bot√µes */
        .controls { margin-top: 20px; }
        button { padding: 15px 30px; background: transparent; color: white; border: 1px solid var(--neon-blue); border-radius: 5px; cursor: pointer; font-family: inherit; transition: 0.3s; }
        button:hover:not(:disabled) { background: var(--neon-blue); color: black; }
        button:disabled { opacity: 0.2; cursor: not-allowed; border-color: #444; }
        .btn-reset { border-color: #555; font-size: 0.8rem; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="round-info">RODADA: <span id="current-round">1</span> / 10</div>
        <div class="score-row">
            <span>HUMANO: <b id="p-score">0</b></span>
            <span>DR. NIM: <b id="n-score">0</b></span>
        </div>
        <div id="intel-mode" style="font-size: 0.7rem; color: #888; margin-top: 10px;">STATUS: REDE NEURAL EM TREINAMENTO</div>
    </div>

    <div class="board" id="board"></div>

    <div class="controls" id="controls">
        <button id="btn1" onclick="move(1)">AVAN√áAR 1</button>
        <button id="btn2" onclick="move(2)">AVAN√áAR 2</button>
    </div>

    <div id="console">> Sistema online. Desafiante, fa√ßa sua jogada.</div>
</div>

<script>
    let currentPos = 0;
    const target = 9;
    let round = 1;
    let playerWins = 0;
    let nimWins = 0;
    let isThinking = false;

    function initBoard() {
        const board = document.getElementById('board');
        board.innerHTML = '';
        for (let i = 1; i <= target; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.id = `cell-${i}`;
            cell.innerHTML = i === target ? '<span class="diamond-icon">üíé</span>' : i;
            board.appendChild(cell);
        }
        updateStatus();
    }

    function updateStatus() {
        document.getElementById('current-round').innerText = round;
        document.getElementById('p-score').innerText = playerWins;
        document.getElementById('n-score').innerText = nimWins;
        
        const modeText = document.getElementById('intel-mode');
        if (round <= 6) {
            modeText.innerText = "STATUS: REDE NEURAL EM TREINAMENTO (COLETANDO DADOS)";
            modeText.style.color = "#888";
        } else {
            modeText.innerText = "STATUS:TREINO CONCLU√çDO";
            modeText.style.color = "var(--neon-pink)";
        }

        document.getElementById('btn1').disabled = (currentPos + 1 > target || isThinking);
        document.getElementById('btn2').disabled = (currentPos + 2 > target || isThinking);

        if (round > 20) {
            finishTournament();
        }
    }

    function move(steps) {
        if (isThinking) return;
        currentPos += steps;
        render(false);

        if (currentPos === target) {
            endRound(true);
            return;
        }

        isThinking = true;
        updateStatus();
        printLog("Dr. Nim est√° analisando sua estrat√©gia...");
        
        setTimeout(nimMove, 1000);
    }

    function nimMove() {
        let step;
        
        if (round <= 6) {
            // FASE DE TREINO: O Dr. Nim joga de forma sub-otimizada
            // Ele escolhe aleatoriamente e pode errar o diamante de prop√≥sito
            step = Math.floor(Math.random() * 2) + 1;
            if (currentPos + step === target && Math.random() > 0.3) {
                step = (step === 1) ? 2 : 1; // "Erra" o pulo final √†s vezes
            }
        } else {
            // FASE IMPOSS√çVEL: Matem√°tica Pura (Complemento de 3)
            // Se o jogador deixar qualquer brecha, o Dr. Nim trava no m√∫ltiplo de 3
            step = (currentPos % 3 === 0) ? 1 : (3 - (currentPos % 3));
        }

        // Garante que ele n√£o pule fora do tabuleiro
        if (currentPos + step > target) step = 1;

        currentPos += step;
        render(true);

        if (currentPos === target) {
            endRound(false);
        } else {
            isThinking = false;
            printLog(`Dr. Nim avan√ßou para a casa ${currentPos}. Sua vez.`);
            updateStatus();
        }
    }

    function render(isNim) {
        document.querySelectorAll('.cell').forEach(c => c.classList.remove('active', 'nim-active'));
        const activeCell = document.getElementById(`cell-${currentPos}`);
        if (activeCell) {
            activeCell.classList.add('active');
            if (isNim) activeCell.classList.add('nim-active');
        }
    }

    function endRound(playerWon) {
        if (playerWon) {
            playerWins++;
            printLog("VOC√ä VENCEU! O Dr. Nim vai castigar seus servi√ßais e fazer vinte rodadas de treinamento!");
        } else {
            nimWins++;
            printLog("DR. NIM VENCEU! Algoritmo de aprendizagem processou seus movimentos.");
        }

        setTimeout(() => {
            round++;
            currentPos = 0;
            isThinking = false;
            if (round <= 10) {
                initBoard();
                printLog(`Iniciando Rodada ${round}...`);
            } else {
                updateStatus();
            }
        }, 2500);
    }

    function printLog(msg) {
        document.getElementById('console').innerHTML = "> " + msg;
    }

    function finishTournament() {
        document.getElementById('controls').innerHTML = `
            <h3 style="color:gold">TORNEIO ENCERRADO</h3>
            <p>${playerWins > nimWins ? "O Desafiante venceu a s√©rie!" : "O Dr. Nim venceu a s√©rie!"}</p>
            <button onclick="location.reload()" class="btn-reset">REINICIAR EXPERIMENTO</button>
        `;
        printLog(`Placar Final: ${playerWins} a ${nimWins}. Analisem o padr√£o matem√°tico agora!`);
    }

    initBoard();
</script>
</body>
</html>